{% extends "admin_base.html" %}
{% block title %}Admin Dashboard - Cyber Bridge{% endblock title %} 
{% block content %}
{% load number_format %}


<main class="container-fluid my-5 px-4">

<h1 class="page-title">Admin Dashboard</h1>
<p style="color: #9CA3AF; margin-bottom: 40px;">System overview and management.</p>

<!-- ================= STAT CARDS ================= -->
<div class="admin-stat-grid">

    <div class="card-stat card-stat-cyan">
        <div class="d-flex justify-content-between">
            <div>
                <div class="card-stat-number card-stat-number-cyan">{{ total_users }}</div>
                <div class="card-stat-label">Total Users</div>
            </div>
            <i class="bi bi-people card-stat-icon card-stat-icon-cyan"></i>
        </div>
    </div>

    <div class="card-stat card-stat-info">
        <div class="d-flex justify-content-between">
            <div>
                <div class="card-stat-number card-stat-number-info">{{ total_complaints }}</div>
                <div class="card-stat-label">Complaints</div>
            </div>
            <i class="bi bi-exclamation-triangle-fill card-stat-icon card-stat-icon-info"></i>
        </div>
    </div>

    <div class="card-stat card-stat-success">
        <div class="d-flex justify-content-between">
            <div>
                <div class="card-stat-number card-stat-number-success">{{ active_hackers }}</div>
                <div class="card-stat-label">Active Hackers</div>
            </div>
            <i class="bi bi-person-check card-stat-icon card-stat-icon-success"></i>
        </div>
    </div>

    <div class="card-stat card-stat-warning">
        <div class="d-flex justify-content-between">
            <div>
                <div class="card-stat-number card-stat-number-warning">{{ total_revenue|indian_compact }}</div>
            <div class="card-stat-label">Total Revenue</div>
        </div>
        <i class="bi bi-currency-rupee card-stat-icon card-stat-icon-warning"></i>
    </div>
</div>


    <div class="card-stat card-stat-danger">
        <div class="d-flex justify-content-between">
            <div>
                <div class="card-stat-number card-stat-number-danger">{{ posts }}</div>
                <div class="card-stat-label">Published Posts</div>
            </div>
            <i class="bi bi-file-earmark-post card-stat-icon card-stat-icon-danger"></i>
        </div>
    </div>

</div>

<!-- ================= MAIN CONTENT ================= -->
<div class="row">

<!-- LEFT COLUMN -->
<div class="col-lg-8 mb-4">

<div class="card-dark p-4 mb-4">
<h3><i class="bi bi-file-earmark-text me-2"></i>Recent Complaints</h3>

<div class="admin-table-wrapper">
<table class="table-dark admin-table">
<thead>
<tr class="table-header">
<th class="table-header-cell">ID</th>
<th class="table-header-cell">Title</th>
<th class="table-header-cell">Business</th>
<th class="table-header-cell">Status</th>
<th class="table-header-cell">Date</th>
<th class="table-header-cell">Actions</th>
</tr>
</thead>
<tbody>

{% for c in recent_complaints %}
<tr class="table-row">
<td class="table-cell">#{{ c.id }}</td>
<td class="table-cell">{{ c.title }}</td>
<td class="table-cell">{{ c.business.company_name }}</td>
<td class="table-cell">
<span class="badge
{% if c.status == 'Pending' %}badge-pending
{% elif c.status == 'In Progress' %}badge-info
{% elif c.status == 'Completed' %}badge-resolved
{% endif %}">
{{ c.status }}
</span>
</td>
<td class="table-cell">{{ c.date_submitted|date:"d M Y" }}</td>
<td class="table-cell"><i class="bi bi-eye"></i></td>
</tr>
{% empty %}
<tr><td colspan="6" class="text-center text-muted">No complaints</td></tr>
{% endfor %}

</tbody>
</table>
</div>
</div>

<div class="card-dark p-4">
<h3><i class="bi bi-people me-2"></i>Recent User Registrations</h3>

<div class="admin-table-wrapper">
<table class="table-dark admin-table">
<thead>
<tr class="table-header">
<th class="table-header-cell">Name</th>
<th class="table-header-cell">Email</th>
<th class="table-header-cell">Type</th>
<th class="table-header-cell">Status</th>
<th class="table-header-cell">Joined</th>
</tr>
</thead>
<tbody>

{% for u in recent_users %}
<tr class="table-row">
<td class="table-cell">{{ u.username }}</td>
<td class="table-cell">{{ u.email }}</td>
<td class="table-cell"><span class="badge badge-info">{{ u.role.name }}</span></td>
<td class="table-cell"><span class="badge badge-active">Active</span></td>
<td class="table-cell">{{ u.date_created|date:"d M Y" }}</td>
</tr>
{% empty %}
<tr><td colspan="5" class="text-center text-muted">No users</td></tr>
{% endfor %}

</tbody>
</table>
</div>
</div>

</div>

<!-- RIGHT COLUMN (SIDE ACTIONS + STATUS) -->
<div class="col-lg-4">

<div class="card-dark p-4 mb-4">
<h3><i class="bi bi-lightning me-2"></i>Quick Actions</h3>

<div class="admin-quick-actions">
<a href="{% url "manage_users" %}" class="button-secondary admin-action-btn">
<i class="bi bi-person-plus"></i>Manage Users
</a>
<a href="{% url "manage_content" %}" class="button-secondary admin-action-btn">
<i class="bi bi-pencil-square"></i>Manage Content
</a>
<a href="#" class="button-secondary admin-action-btn">
<i class="bi bi-file-earmark-check"></i>Review Complaints
</a>
<a href="{% url "manage_payment" %}" class="button-secondary admin-action-btn">
<i class="bi bi-wallet2"></i>Payment Management
</a>
</div>
</div>

<div class="card-dark p-4">
<h3><i class="bi bi-gear me-2"></i>System Status</h3>

<div class="status-item"><span>Server</span><span class="badge badge-resolved">Online</span></div>
<div class="status-item"><span>Database</span><span class="badge badge-resolved">Connected</span></div>
<div class="status-item"><span>Payment Gateway</span><span class="badge badge-resolved">Active</span></div>
<div class="status-item"><span>Last Backup</span><span>2 hours ago</span></div>

</div>

</div>

</div>
</main>

<!-- ================= FOOTER (RESTORED) ================= -->


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
{% endblock content %}
